<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Document sans nom</title>
<link href="../css/base.css" rel="stylesheet" type="text/css">
</head>

<body>
<div id="AU_ec48fb91-0655-4d34-b79c-68fac63fba8b" uri="ImagesUri_../download/d7372f46-d115-41d3-a503-a3b7f321295f/images\">
  <h1>Classe Client</h1>
  <p>Voici le code de cette classe :</p>
  <pre>package entite;      import java.io.Serializable;   import java.time.Instant;   import java.util.Date;      import javax.persistence.Basic;   import javax.persistence.CascadeType;   import javax.persistence.Entity;   import javax.persistence.Id;   import javax.persistence.NamedQueries;   import javax.persistence.NamedQuery;   import javax.persistence.OneToOne;   import javax.persistence.Temporal;   import javax.persistence.TemporalType;<strong>       @Entity</strong>   public class Client implements Serializable {          private static final long serialVersionUID = 1L;          // Propriétés de base de la classe       // -------------------------------       // l’identifiant en base de données<strong>        @Id</strong>       private String code;          @Basic       private String nom;          private String prenom;          private boolean carte_fidele;<strong>           @Temporal(TemporalType.DATE)</strong>       private Date date;<strong>           @OneToOne(cascade=CascadeType.ALL)</strong>       private Adresse adresse;          // CONSTRUCTEURS       // -------------       // 1er Constructeur       // pour la création complète d’un client       // limitée ici à 5 propriétés pour alléger le code       public Client(String code,                String nom, String prenom,               boolean carteFidelite, Instant creation) {           this.code = code;           this.nom = nom;           this.prenom = prenom;           carte_fidele = carteFidelite;           setDateCreation(creation));       }          /**        * Utilisé par JPA.        */       public Client() {           super();       }          // Getters de base       // ---------------       public String getCode() {           return code;       }          public String getNom() {           return nom;       }          public String getPrenom() {           return prenom;       }          public boolean isCarteFidele() {           return carte_fidele;       }          public Instant getDateCreation() {           return date.toInstant();       }          public Adresse getAdresse() {           return this.adresse;       }          // Setters       public void setCode(String code) {           this.code = code;       }          public void setNom(String nom) {           this.nom = nom;       }          public void setPrenom(String prenom) {           this.prenom = prenom;       }          public void setCarteFidele(boolean carte_fidele) {           this.carte_fidele = carte_fidele;       }          public void setDateCreation(Instant date_creation) {           this.date = Date.from(date_creation);       }              public void setAdresse(Adresse adresse) {           this.adresse = adresse;       }       }   </pre>
  <p>Contrairement à la classe <strong>ModeReglements</strong>, la propriété <strong>code</strong> ne possède pas d’annotation @GeneratedValue.  Cela veut dire qu’il faudra affecter ce code manuellement, la base  de données ne le générant pas automatiquement.</p>
  <p>La date de création du client est  stockée dans le système. JPA utilise l’annotation <strong>@Temporal</strong> pour convertir automatiquement l’objet <strong>Date</strong> au format <strong>SQL DATE</strong>, à l’aide d’une indication supplémentaire :  la variable <strong>TemporalType.DATE</strong>.</p>
  <p>À l’heure actuelle, la version 2.1.0  de JPA ne gère pas les propriétés de  type time de Java 8. On ne peut donc pas déclarer des attributs  gérés par JPA de type java.time.Instant ou java.time.LocalDate.  Seuls les types <strong>java.util.Date</strong> ou <strong>java.util.Calendar</strong> sont gérés nativement.</p>
  <p>Il convient donc dans le code de faire la  transformation voulue, à l’aide des méthodes :</p>
  <pre>    public void setDateCreation(Instant date_creation) {           this.date = <strong>Date.from</strong>(date_creation);       }  </pre>
  <p>et :</p>
  <pre>    public Instant getDateCreation() {           return date.<strong>toInstant</strong>();       }  </pre>
  <p>Une fois ce code introduit, les informations  temporelles sont automatiquement converties et stockées  dans la base de données grâce à JPA.</p>
  <p>La classe <strong>Client</strong> établit une relation avec une instance de la  classe <strong>Adresse</strong>. Chaque client dans l’application est considéré comme  ayant une adresse au maximum, et chaque adresse correspond à un  seul client. Cette relation est formalisée par l’annotation <strong>@OneToOne</strong>. Cette annotation est ensuite paramétrée  avec <strong>cascade</strong>, qui indique que lors de toute opération sur  une entité de la classe <strong>Client</strong>, l’adresse liée sera également affectée  par cette opération.</p>
  <p>La classe <strong>Adresse</strong> est très simple :</p>
  <pre>package entite;      import java.io.Serializable;      import javax.persistence.Entity;   import javax.persistence.GeneratedValue;   import javax.persistence.Id;      @Entity   public class Adresse implements Serializable {          private static final long serialVersionUID = 1L;          @Id<strong>        @GeneratedValue</strong>       private Long id;              private String rue;              private String codePostal;              private String ville;          public String getRue() {           return this.rue;       }          public void setRue(String rue) {           this.rue = rue;       }          public String getCodePostal() {           return this.codePostal;       }          public void setCodePostal(String codePostal) {           this.codePostal = codePostal;       }          public String getVille() {           return this.ville;       }          public void setVille(String ville) {           this.ville = ville;       }   }  </pre>
</div>

</body>
</html>
