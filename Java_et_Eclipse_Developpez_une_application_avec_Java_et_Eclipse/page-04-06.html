<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Document sans nom</title>
<link href="../css/base.css" rel="stylesheet" type="text/css">
</head>

<body>
<div id="AU_ba95f315-1b98-4e2d-bcac-d46226ddf0f7" uri="ImagesUri_../download/d7372f46-d115-41d3-a503-a3b7f321295f/images\">
  <h1>Création d’un menu</h1>
  <p>Un menu va maintenant être créé dans  cette première fenêtre, très rapidement  grâce à WindowBuilder.</p>
  <div>
    <p> Dans la palette de WindowBuilder, développez  la section <strong>Menu</strong>.</p>
  </div>
  <div>
    <p>Le début de cette opération  consiste à ajouter une barre de menus.</p>
  </div>
  <div>
    <p> Choisissez le composant <strong>JMenuBar</strong> et déposez-le sur la barre de titre de la prévisualisation  de la fenêtre.</p>
  </div>
  <div>
    <div><img src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5CPUCE.PNG?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA" alt="" width="20px"></div>
    <div>
      <p>Une inscription verte devrait apparaître  pour indiquer où placer la barre de menus.</p>
    </div>
  </div>
  <div>
    <div><img alt="images/02-35.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-35.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <p>Il est dorénavant possible d’ajouter  des menus à cette barre de menus.</p>
  <div>
    <p> Sélectionnez et déposez le  composant <strong>JMenu</strong> depuis la palette WindowBuilder vers la barre de menus  qui vient d’être créée.</p>
  </div>
  <div>
    <div><img alt="images/02-36.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-36.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <div>
    <p>Un nouveau menu se crée, WindowBuilder  demandant son nom, par exemple <strong>Fichier</strong>.</p>
  </div>
  <div>
    <div><img alt="images/02-37.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-37.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <div>
    <p> Agrandissez la fenêtre pour pouvoir  insérer les autres menus.</p>
  </div>
  <div>
    <p> Déposez un autre composant <strong>JMenu</strong> cette fois-ci à droite du menu <strong>Fichier</strong> que vous venez de créer.</p>
  </div>
  <div>
    <p> Changez le libellé de sa propriété <strong>text</strong> par <strong>Client</strong>.</p>
  </div>
  <p>Il s’agit maintenant d’ajouter des éléments  (appelés également items) pour chaque menu.</p>
  <div>
    <p> Dans la prévisualisation, cliquez  sur le menu <strong>Fichier</strong>.</p>
  </div>
  <div>
    <p> Sélectionnez et déposez un  composant <strong>JMenuItem</strong> depuis la palette vers la zone nommée <strong>(Add items here)</strong>.</p>
  </div>
  <div>
    <p> Nommez cet item <strong>Quitter</strong>.</p>
  </div>
  <div>
    <p> Testez la fenêtre. L’item <strong>Quitter</strong> est présent mais inactif.</p>
  </div>
  <p>Pour faire simple, le menu <strong>Fichier</strong> comportera un seul item.</p>
  <p>Il reste à terminer le menu en le  complétant de la manière suivante :</p>
  <div>
    <p> Sélectionnez un composant <strong>JMenu</strong> dans la palette et déposez-le dans le menu <strong>Client</strong>. Le menu <strong>Client</strong> s’ouvre si la souris passe dessus, pour permettre de  déposer le composant dans la zone <strong>(Add items here)</strong>.</p>
  </div>
  <div>
    <p> Changez le nom du sous-menu qui vient d’être  créé en <strong>Gestion</strong>, en tapant ce nom dans la prévisualisation  ou en changeant la propriété <strong>text</strong> dans la section <strong>Properties</strong>.</p>
  </div>
  <div>
    <p> Ajoutez les items suivants au sous-menu <strong>Gestion</strong>.</p>
  </div>
  <div>
    <div><img alt="images/02-38.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-38.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <div>
    <div><img src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5CPUCE.PNG?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA" alt="" width="20px"></div>
    <div>
      <p>La ligne grisée entre <strong>Rechercher</strong> et <strong>Supprimer</strong> s’obtient en déposant un composant <strong>JSeparator</strong> comme item de menu.</p>
    </div>
  </div>
  <div>
    <p>La prochaine étape est d’associer  une action à l’item de menu <strong>Quitter</strong>.</p>
  </div>
  <div>
    <p> Sélectionnez l’item <strong>Quitter</strong> dans le menu, faites un clic droit et sélectionnez  l’option <strong>Set Action - New</strong>.</p>
  </div>
  <div>
    <div><img alt="images/02-39.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-39.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <p>Le texte de l’item change. C’est tout à fait  normal à ce stade.</p>
  <div>
    <p> Cliquez sur l’onglet <strong>Source</strong> pour afficher le code source de la classe Java.</p>
  </div>
  <p>WindowBuilder a rajouté automatiquement  plusieurs lignes :</p>
  <pre>private final Action action = new SwingAction();    ...       JMenuItem mntmQuitter = new JmenuItem("Quitter");       mntmQuitter.<strong>setAction</strong>(action);       mnNewMenu.add(mntmQuitter);   ...    private class SwingAction extends <strong>AbstractAction</strong> {       public SwingAction() {<strong>            putValue</strong>(<strong>NAME</strong>, "SwingAction");           putValue(<strong>SHORT_DESCRIPTION</strong>, "Some short description");       }       public void <strong>actionPerformed</strong>(ActionEvent e) {       }   }  </pre>
  <p>Une action a été rajoutée à l’item  de menu via la propriété <strong>action</strong>.</p>
  <p>La classe de cette action s’appelle <strong>SwingAction</strong> (il s’agit d’un nom généré automatiquement),  qui dérive du type <strong>AbstractAction</strong>.</p>
  <p>Quand l’utilisateur clique sur l’item <strong>Quitter</strong>, le code de la méthode <strong>actionPerformed</strong> est exécuté.</p>
  <div>
    <p> Modifiez la méthode par le code suivant :</p>
  </div>
  <pre>    public void actionPerformed(ActionEvent e) {<strong>              dispose();</strong>       }</pre>
  <p>La méthode <strong>dispose()</strong> permet de relâcher les ressources graphiques  de la fenêtre et de la supprimer de l’écran.  Comme il s’agit de la seule fenêtre de notre première  application, le programme se terminera ensuite tout seul.</p>
  <div>
    <div><img src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5CPUCE.PNG?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA" alt="" width="20px"></div>
    <div>
      <p>Il existe une commande plus rapide  pour terminer un programme Java : <strong>System.exit(0);</strong>. Cette commande permet en plus de donner des  codes de retour au programme mais son utilisation peut être  facilement abusive. D’une manière générale,  proposez un point de sortie unique pour votre application, ce qui  permet de fermer proprement les connexions aux bases de données par  exemple.</p>
    </div>
  </div>
  <div>
    <p> Testez la fenêtre en lançant  le programme par [Ctrl][F11] et  vérifiez que cliquer sur <strong>SwingAction</strong> ferme bien la fenêtre.</p>
  </div>
  <p>En revenant sur la console d’Eclipse, vous  devez voir l’expression <strong>&lt;terminated&gt;</strong>.</p>
  <div>
    <div><img alt="images/02-40.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-40.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <p>Dans les applications graphiques professionnelles,  les raccourcis-clavier sont essentiels car ils permettent aux utilisateurs  d’accélérer les actions les plus courantes, gagner  du temps et augmenter leur productivité.</p>
  <p>L’étape suivante permet d’introduire  ces raccourcis-clavier en changeant les propriétés  de l’action.</p>
  <div>
    <p> Modifiez le constructeur de la classe <strong>SwingAction</strong> avec les lignes suivantes :</p>
  </div>
  <pre>public SwingAction() {        putValue(NAME, "Quitter");       putValue(SHORT_DESCRIPTION, "Ferme l’application");       putValue(<strong>MNEMONIC_KEY, KeyEvent.VK_Q);        putValue(ACCELERATOR_KEY,                     KeyStroke.getKeyStroke(KeyEvent.VK_Q,                    InputEvent.CTRL_DOWN_MASK));</strong>   }  </pre>
  <div>
    <p> Rectifiez les imports en appuyant en même  temps sur les touches [Ctrl][Shift] <strong>O</strong> (pas le zéro, mais la lettre O). Il s’agit  de l’accélérateur d’Eclipse pour réorganiser  les imports de la classe et lui faire connaître les classes <strong>KeyStroke</strong> et <strong>InputEvent</strong>. </p>
  </div>
  <div>
    <p> Testez la fenêtre en lançant  le programme, en vérifiant que le libellé est  bien changé, que la lettre Q est soulignée, et  que Ctrl-Q s’affiche bien à côté de l’action.</p>
  </div>
  <div>
    <div><img alt="images/02-41.png" src="http://www.eni-training.com/download/d7372f46-d115-41d3-a503-a3b7f321295f/images%5C02-41.png?id=AAEAAAD%2f%2f%2f%2f%2fAQAAAAAAAAAMAgAAAE1FbmkuRWRpdGlvbnMuTWVkaWFwbHVzLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAJ0VuaS5FZGl0aW9ucy5NZWRpYXBsdXMuQ29tbW9uLldhdGVybWFyawIAAAAHcGlzVGV4dAlwaWR0ZURhdGUBAA0CAAAABgMAAAAyT0RPVUwgQWxhaW4gLSA1NDJhM2ZhMC1kYTJkLTQzMzctOTE5Zi05OGQ1MmM5ZjhiN2FHtOE%2b4xXTiAsA"></div>
  </div>
  <div>
    <p> Appuyez sur [Ctrl] <strong>Q</strong>. La fenêtre doit se fermer.</p>
  </div>
</div>

</body>
</html>
